<!DOCTYPE html>
<html>
<head>
    <title>XML Parser</title>
     <style>
        body {
            background-color: #f3f6f4;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        .courier-header {
            font-family: Courier, monospace;
            font-size: 32px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>XML Parser</h1>
    <input type="file" id="xmlFileInput" accept=".xml">
    <button id="processButton">Process XML</button>
    <a id="downloadLink" style="display: none;">Download Output</a>

    <script>
        document.getElementById('processButton').addEventListener('click', async () => {
            const fileInput = document.getElementById('xmlFileInput');
            const downloadLink = document.getElementById('downloadLink');
            const tbody = document.createElement('tbody');

            if (fileInput.files.length === 0) {
                return;
            }

            const xmlFile = fileInput.files[0];
            const xmlData = await xmlFile.text();

            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlData, 'text/xml');
            const conveyorElements = xmlDoc.querySelectorAll('Conveyor');

            tbody.innerHTML = ''; // Clear existing rows

            conveyorElements.forEach(conveyorElement => {
                const markedAttribute = conveyorElement.getAttribute('Marked');
                const refNameElements = conveyorElement.querySelectorAll('RefName');

                let iopcountValue = '';
                let psvoltageValue = '';

                refNameElements.forEach(refNameElement => {
                    const propertyName = refNameElement.textContent;
                    const valueElement = refNameElement.nextElementSibling;

                    if (propertyName === 'iopcount') {
                        iopcountValue = valueElement.textContent;
                    } else if (propertyName === 'PSvoltage') {
                        psvoltageValue = valueElement.textContent;
                    }
                });

                const row = tbody.insertRow();
                const cellMarked = row.insertCell();
                const cellIopcount = row.insertCell();
                const cellPSvoltage = row.insertCell();

                cellMarked.textContent = markedAttribute;
                cellIopcount.textContent = iopcountValue;
                cellPSvoltage.textContent = psvoltageValue;
            });

            // Create a table
            const table = document.createElement('table');
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Marked</th>
                        <th>iopcount</th>
                        <th>PSvoltage</th>
                    </tr>
                </thead>
            `;
            table.appendChild(tbody);

            // Create a Blob containing the table content
            const blob = new Blob([table.outerHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);

            // Set the download link properties
            downloadLink.href = url;
            downloadLink.download = 'output.html';
            downloadLink.style.display = 'block';
        });
    </script>
</body>
</html>
